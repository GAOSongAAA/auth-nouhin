<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>CollaborPortal JWTÊ§úË®º„ÉÜ„Çπ„Éà</title>
</head>
<body>
    <button onclick="testJwtValidation('/api/v1/normality-check')">Normality Check 1</button>
    <button onclick="testJwtValidation('/api/v1/normality-check-2')">Normality Check 2</button>
    <button onclick="testJwtValidation('/api/v1/login')">Login Check</button>

    <div id="result"></div>

    <script>
        function getAuthToken() {
            const match = document.cookie.match(/(?:^|;\s*)AuthToken=([^;]+)/);
            return match ? decodeURIComponent(match[1]) : null;
        }

        function testJwtValidation(endpoint) {
            const result = document.getElementById("result");
            result.textContent = `üîé ${endpoint} „Å´ÂØæ„Åó„Å¶Ê§úË®º„ÇíÈñãÂßã...`;

            const token = getAuthToken();
            const headers = {};
            if (token) {
                headers['Authorization'] = `Bearer ${token}`;
            } else {
                result.textContent = `‚ö†Ô∏è Cookie„Åã„ÇâAuth_Token„ÅåÂèñÂæó„Åß„Åç„Åæ„Åõ„Çì„ÄÇ`;
                return;
            }

            fetch(endpoint, {
                method: 'GET',
                headers
            })
                .then(res => res.text().then(text => ({ status: res.status, text })))
                .then(({ status, text }) => {
                    if (status === 200) {
                        result.textContent = `‚úÖ ÊàêÂäü (${status}): ${text}`;
                    } else if (status === 401) {
                        result.textContent = `‚ö†Ô∏è Ë™çË®ºÂ§±Êïó (${status}) - „Éà„Éº„ÇØ„É≥„ÅåÁÑ°Âäπ„ÅãÊúüÈôêÂàá„Çå„Åß„Åô`;
                    } else {
                        result.textContent = `‚ÑπÔ∏è ÂøúÁ≠î (${status}): ${text}`;
                    }
                })
                .catch(err => {
                    result.textContent = `‚ùå „Ç®„É©„Éº: ${err.message}`;
                });
        }
    </script>
</body>
</html>
