<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.collaboportal.shoho.repository.DcfCodeMapper">
    <select id="getDcfCode" resultType="com.collaboportal.shoho.entity.DcfCode" 
            parameterType="com.collaboportal.shoho.model.DcfCodeRequestParameter">
        SELECT DISTINCT
            RTRIM(I_SCD) as dcf_cod
        FROM
            shohomoto_info.MS_MR_TANTOU mmt
        INNER JOIN shohomoto_info.TR_SHOHOMOTO_INF tsi
        ON mmt.I_SCD = tsi.I_DCF_COD
        <where>
            mmt.I_MR_M = #{email}
            <if test="kkk_cod != null">
                AND mmt.I_KIKAKU_ID = #{kkk_cod}
            </if>
        </where>
        ORDER BY
            RTRIM(I_SCD) ASC
    </select>
</mapper>