import{d as Ae,b7 as Fe,x as Se,r as a,ct as Z,z as De,o as Ce,a as v,c as Be,f as s,b as S,w as l,Q as xe,j as b,cd as Le,E as D,L as d,i as h,e as ee,t as V,B as g,cF as Ne,cG as $e,cH as Ie,cI as Ke,cJ as Pe,k as Re,J as te,cK as Ve,cL as Ue,cM as He}from"./index-8667328b.js";import{H as Me,V as je,f as Te,a as U,b as u,l as Ge,g as qe,n as Je}from"./Header-3fbbd51b.js";import{_ as y}from"./CBtn.vue_vue_type_script_setup_true_lang-724c5b83.js";import{C as H,a as se,g as Oe,F as ze}from"./FileSaver.min-ab610276.js";const Ye={class:"customer_search_content"},Qe={class:"customer_search_menu"},We={class:"customer_search_inner"},Xe=["onClick"],Ze=Ae({__name:"PrescriptionStatusList",setup(et){const{mobile:o}=Fe(),ae=b(Ne),le=b($e),ne=b(Ie),ue=b(Ke),oe=b(Pe),i=b(Re);Le();const M=Se("infScroll"),_={title:"",value:""},B=a([_]),x=a(!0),L=a([_]),j=a(!0),N=a([_]),r=a(""),w=a(""),E=a(""),ie=a(""),re=a("0"),p=a(""),f=a(""),ce=a(null),$=a(!1),I=a(),k=a(0);a(0);const T=a(""),G=a(""),q=a(""),m=a([]),C=a(0),de=Z([{key:"shm_kkk_nm",title:"\u4F01\u753B\u540D",sortable:!1,tdAlign:"left",class:"",width:"3%"},{key:"shm_tss_cnt",title:"\u8ABF\u67FB\u6570",sortable:!1,tdAlign:"right",class:"",width:"3%"},{key:"shm_mkts_cnt",title:"\u672A\u56DE\u7B54\u6570",sortable:!1,tdAlign:"right",class:"",width:"3%"},{key:"shm_kts_cnt",title:"\u56DE\u7B54\u6570",sortable:!1,tdAlign:"right",class:"",width:"3%"},{key:"shm_shmhm_cnt",title:"\u51E6\u65B9\u5143\u4E0D\u660E\u6570",sortable:!1,tdAlign:"right",class:"",width:"3%"},{key:"shm_snrykhm_cnt",title:"\u8A3A\u7642\u79D1\u4E0D\u660E\u6570",sortable:!1,tdAlign:"right",class:"",width:"3%"}]),_e=Z([{key:"shm_ksy_nm",title:"\u4F1A\u793E",sortable:!1,tdAlign:"left",class:"",width:"3%"},{key:"shm_egb_nm",title:"\u55B6\u696D\u90E8",sortable:!1,tdAlign:"left",class:"",width:"3%"},{key:"shm_kkk_nm",title:"\u4F01\u753B\u540D",sortable:!1,tdAlign:"left",class:"",width:"3%"},{key:"shm_tss_cnt",title:"\u8ABF\u67FB\u6570",sortable:!1,tdAlign:"left",class:"",width:"3%"},{key:"shm_mkts_cnt",title:"\u672A\u56DE\u7B54\u6570",sortable:!1,tdAlign:"left",class:"",width:"3%"},{key:"shm_kts_cnt",title:"\u56DE\u7B54\u6570",sortable:!1,tdAlign:"left",class:"",width:"3%"},{key:"shm_shmhm_cnt",title:"\u51E6\u65B9\u5143\u4E0D\u660E\u6570",sortable:!1,tdAlign:"left",class:"",width:"3%"},{key:"shm_snrykhm_cnt",title:"\u8A3A\u7642\u79D1\u4E0D\u660E\u6570",sortable:!1,tdAlign:"left",class:"",width:"3%"},{key:"shm_detil_lnk",title:"\u8A73\u7D30",sortable:!1,tdAlign:"left",class:"",width:"3%"}]),me=De(()=>o.value?de:_e),ve=async()=>{if($.value)return;$.value=!0;const n={limit:te,offset:C.value*te+1,ksh_cod:r.value,egb_cod:w.value,kkk_cod:E.value,urg_ymd_stt:p.value,urg_ymd_end:f.value},e=await ue.get(n);if($.value=!1,e.nb_err_cod!=="200"){if(i.value.showIfNetworkError(e.nb_err_cod),e.nb_err_cod==="404")throw i.value.show(D.E000002),new Error;return}const t=e.shm_inf.map(c=>(c.shm_detil_lnk="\u8A73\u7D30",c));if(t.forEach(c=>{}),m.value=m.value.concat(t),C.value++,k.value=e.all_su,k.value<=m.value.length)throw new Error},J=async()=>{M.value&&M.value.$emit("load",{side:"end",done(){}})},pe=async({done:n})=>{I.value=n;try{await ve(),n("ok")}catch{n("empty")}},O=async()=>{const n={ksh_cod:r.value,egb_cod:w.value,kkk_cod:E.value,urg_ymd_stt:p.value,urg_ymd_end:f.value},e=await oe.get(n);if(e.nb_err_cod!=="200"){i.value.showIfNetworkError(e.nb_err_cod),e.nb_err_cod==="404"&&i.value.show(D.E000002);return}const t=new Blob(["\uFEFF"+e.shm_inf],{type:"text/csv"}),c="prescription_status_list_"+Oe();ze.exports.saveAs(t,c)},fe=(n,e,t,c,K,A,F)=>{ke(n,e,t,c,K,A,F);const P="/",R="prescriptionListtab";Ve(Ue),ce.value=window.open(P,R)},ke=(n,e,t,c,K,A,F)=>{A===null&&(A=""),F===null&&(F="");const P=`{"KSH_NO": "${n}","KSH_NM": "${e}","EGB_NO": "${t}","EGB_NM": "${c}", "KKK_NM": "${K}","URG_YMD_STT": "${A}","URG_YMD_END": "${F}"}`,R=new TextEncoder().encode(P),Ee=btoa(String.fromCharCode(...R)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");He(Ee)};window.addEventListener("resize",be);function be(){o.value?(G.value="\u55B6\u696D\u90E8",T.value="\u4F1A\u793E",q.value="\u652F\u5E97"):(G.value="",T.value="",q.value="")}const z=async()=>{const n={},e=await ae.get(n);if(e.nb_err_cod!=="200"){x.value=!0,i.value.showIfNetworkError(e.nb_err_cod),e.nb_err_cod==="404"&&i.value.show(D.E000008);return}else B.value=[_].concat(e.lst_ksh_inf.map(t=>({title:t.ksh_nm,value:t.ksh_no}))),await Y()},he=async()=>{const n={ksh_no:r.value},e=await le.get(n);if(e.nb_err_cod!=="200"){i.value.showIfNetworkError(e.nb_err_cod),e.nb_err_cod==="404"&&i.value.show(D.E000009);return}else L.value=[_].concat(e.lst_bu_inf.map(t=>({title:t.bu_nm,value:t.bu_no})))},Y=async()=>{const n={},e=await ne.get(n);if(e.nb_err_cod!=="200"){i.value.showIfNetworkError(e.nb_err_cod),e.nb_err_cod==="404"&&i.value.show(D.E000013);return}else N.value=[_].concat(e.lst_kkk_inf.map(t=>({title:t.kkk_nm,value:t.kkk_no})))},ge=async()=>{W(),r.value!=null&&r.value!==""&&await he()},Q=async()=>{ye(),W(),we(),ie.value="",re.value="0",p.value="",f.value="",await z(),await Y()},ye=()=>{B.value=[_],r.value="",x.value=!0},W=()=>{L.value=[_],w.value="",j.value=!0},we=()=>{N.value=[_],E.value=""},X=()=>{I.value&&I.value("ok"),C.value=0,m.value=[],k.value=0};return Ce(async()=>{await z()}),(n,e)=>(v(),Be(xe,null,[s(Me,{"menu-view-fg":!0}),S("div",Ye,[S("div",Qe,[s(je,{fluid:"",class:"ma-0 px-0 pt-2 pb-2"},{default:l(()=>[s(U,{class:"mx-0"},{default:l(()=>[s(u,{cols:d(o)?6:"",class:"pt-1 pb-1"},{default:l(()=>[s(H,{title:"\u4F1A\u793E",class:"display_condition_select mr-6 w-100",items:B.value,"selected-item":r.value,"onUpdate:selectedItem":e[0]||(e[0]=t=>r.value=t),disabled:!x.value,"onUpdate:modelValue":e[1]||(e[1]=t=>ge())},null,8,["items","selected-item","disabled"])]),_:1},8,["cols"]),s(u,{cols:d(o)?6:"",class:"pt-1 pb-1"},{default:l(()=>[s(H,{title:"\u55B6\u696D\u90E8",class:"display_condition_select mr-6 w-100",items:L.value,"selected-item":w.value,"onUpdate:selectedItem":e[2]||(e[2]=t=>w.value=t),disabled:r.value==null||r.value===""||!j.value},null,8,["items","selected-item","disabled"])]),_:1},8,["cols"]),s(u,{cols:d(o)?6:"",class:"pt-1 pb-1"},{default:l(()=>[s(H,{title:"\u4F01\u753B\u540D",class:"display_condition_select mr-6 w-100",items:N.value,"selected-item":E.value,"onUpdate:selectedItem":e[3]||(e[3]=t=>E.value=t)},null,8,["items","selected-item"])]),_:1},8,["cols"])]),_:1}),s(U,{class:"mx-0"},{default:l(()=>[s(u,{cols:d(o)?6:"",class:"pt-1"},{default:l(()=>[s(se,{date:p.value,"onUpdate:date":e[4]||(e[4]=t=>p.value=t),placeholder:"\u58F2\u4E0A\u65E5 \u958B\u59CB\u65E5"},null,8,["date"])]),_:1},8,["cols"]),s(u,{cols:"1",class:"pt-1"},{default:l(()=>e[12]||(e[12]=[S("div",{class:"test_text d-flex align-center justify-center fill-height"}," \uFF5E ",-1)])),_:1}),s(u,{cols:d(o)?6:"",class:"pt-1"},{default:l(()=>[s(se,{date:f.value,"onUpdate:date":e[5]||(e[5]=t=>f.value=t),placeholder:"\u58F2\u4E0A\u65E5 \u7D42\u4E86\u65E5"},null,8,["date"])]),_:1},8,["cols"]),s(Ge),!d(o)&&m.value.length>0?(v(),h(u,{key:0,cols:"auto",class:"d-flex align-center pt-1 pb-1"},{default:l(()=>[ee(" \u4EF6\u6570\uFF1A"+V(k.value)+"\u4EF6 ",1)]),_:1})):g("",!0),d(o)?g("",!0):(v(),h(u,{key:1,cols:"auto",class:"pt-2 pb-0"},{default:l(()=>[s(y,{class:"text-black nouki_btn_outlined",text:"csv\u51FA\u529B",prependIcon:"",variant:"outlined",disabled:!1,onClick:e[6]||(e[6]=t=>O())})]),_:1})),d(o)?g("",!0):(v(),h(u,{key:2,cols:"auto",class:"pt-2 pb-0"},{default:l(()=>[s(y,{class:"text-black nouki_btn_outlined",text:"\u30AF\u30EA\u30A2",prependIcon:"",variant:"outlined",onClick:e[7]||(e[7]=t=>Q())})]),_:1})),d(o)?g("",!0):(v(),h(u,{key:3,cols:"auto",class:"pt-2 pb-0"},{default:l(()=>[s(y,{type:"submit",text:"\u691C\u7D22",class:"customer_search_company_btn nouki_btn",onClick:e[8]||(e[8]=t=>(X(),J()))})]),_:1}))]),_:1}),d(o)?(v(),h(U,{key:0,class:"mx-0 d-flex justify-end"},{default:l(()=>[m.value.length>0?(v(),h(u,{key:0,cols:"auto",class:"d-flex align-center pt-0"},{default:l(()=>[ee(" \u4EF6\u6570\uFF1A"+V(k.value)+"\u4EF6 ",1)]),_:1})):g("",!0),s(u,{cols:"auto",class:"pt-0"},{default:l(()=>[s(y,{class:"text-black nouki_btn_outlined",text:"csv\u51FA\u529B",prependIcon:"",variant:"outlined",disabled:!1,onClick:e[9]||(e[9]=t=>O())})]),_:1}),s(u,{cols:"auto",class:"pt-0"},{default:l(()=>[s(y,{class:"text-black nouki_btn_outlined",text:"\u30AF\u30EA\u30A2",prependIcon:"",variant:"outlined",onClick:e[10]||(e[10]=t=>Q())})]),_:1}),s(u,{cols:"auto",class:"pt-0"},{default:l(()=>[s(y,{type:"submit",text:"\u691C\u7D22",class:"customer_search_company_btn nouki_btn",onClick:e[11]||(e[11]=t=>(X(),J()))})]),_:1})]),_:1})):g("",!0)]),_:1})])]),S("div",We,[s(Te,{ref:"infScroll",mode:C.value>=1&&m.value.length<k.value?"intersect":"manual",class:"infinite-scroll-container",onLoad:pe},{"load-more":l(()=>e[13]||(e[13]=[])),empty:l(()=>e[14]||(e[14]=[])),default:l(()=>[s(qe,{density:"compact",headers:me.value,items:m.value,"item-value":"detile-link","no-data-text":"",hover:""},{["item.shm_detil_lnk"]:l(({item:t})=>[S("span",{class:"customer_code_item_a",onClick:c=>fe(t.shm_ksy_cod,t.shm_ksy_nm,t.shm_egb_cod,t.shm_egb_nm,t.shm_kkk_nm,p.value,f.value),target:"_blank"},V(t.shm_detil_lnk),9,Xe)]),_:2},1032,["headers","items"])]),_:1},8,["mode"])])],64))}});const ut=Je(Ze,[["__scopeId","data-v-2a9d0570"]]);export{ut as default};
